<p>
  This example will guide you through the process of applying a pre-trained network (i.e. the weights have been trained),
  to a SITELLE data cube. This example will use the network trained to predict velocity and broadening values, therefore,
  we will be applying this to an SN3 cube.
</p>
<p>
  The code will read in a the network and a datacube. We will then step through each pixel in the datacube, extract the
  spectrum, subtract the background, interpolate the background-subtracted spectrum onto the reference spectrum's x-axis,
  and finally apply the network to extract the velocity and broadening parameters. Let's start with our imports -- I apologize
  for all of them!
</p>
<pre class="line-numbers">
  <code class="language-python">
    import os
    import numpy as np
    import matplotlib.pyplot as plt
    import time
    from keras.optimizers import Adam
    from keras.models import load_model
    from orcs.process import SpectralCube
    from astropy.io import fits
    from pickle import load
    from scipy import interpolate
  </code>
</pre>

<p>
  Now we need to define our directories, cube name, and location of the deep frame. If you have not created a deep frame
  for the cube, please do so now. Also, be sure to have the reference spectrum in the home directory.
</p>

<pre>
  <code class="language-python">
    home_dir = '/path/to/main/directory/containing/data'   # Location weights file
    cube_dir = '/path/to/cubes'  # Path to data cube
    cube_name = 'cube_name'  # don't add .hdf5 extension
    output_dir = '/path/to/output'  # Path to output directory
    output_name = 'output_name'  # output file prefix
    deep_file = '/full/path/to/deep/fits'  # Path to deep image fits file: required for header
  </code>
</pre>